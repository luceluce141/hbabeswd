<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Typing Speed Test</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;900&display=swap');
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; }
    body {
      font-family: 'Poppins', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #121212;
      color: #eee;
    }
    .container {
      width: 90%; max-width: 600px;
      background: #1f1f1f;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 4px 4px 12px rgba(0,0,0,0.6), -4px -4px 12px rgba(255,255,255,0.05);
      display: flex;
      flex-direction: column;
      gap: 24px;
    }
    #highDisplay, #resultDisplay {
      font-size: 1.25rem;
      font-weight: 700;
      text-align: center;
      padding: 8px 12px;
      border-radius: 8px;
      display: none;
    }
    #highDisplay {
      color: #ffd700;
      background: #333300;
    }
    #resultDisplay {
      color: #2ecc71;
      background: #223322;
    }
    .controls {
      display: flex; gap: 16px; justify-content: flex-end; align-items: center; flex-wrap: wrap;
    }
    .controls button, .controls input {
      background: #292929; border: none; border-radius: 8px; padding: 8px 16px; color: #eee; font-size: 14px;
    }
    .controls button { cursor: pointer; }
    .controls button:hover { background: #333; }
    .controls input { flex: 1; min-width: 120px; }
    h1 { text-align: center; font-size: 2rem; font-weight: 600; }
    #startBtn {
      width: 100%; padding: 14px; font-size: 1rem; font-weight: 600; color: #fafafa;
      background: #3a3a3a; border: none; border-radius: 12px; cursor: pointer;
    }
    #startBtn:hover { background: #4a4a4a; }
    .word-container { text-align: center; }
    .word-display { font-size: 2.5rem; font-weight: 500; letter-spacing: 2px; margin-bottom: 8px; }
    .word-display span.correct { color: #2ecc71; }
    .word-display span.incorrect { color: #e74c3c; }
    .next-word { font-size: 0.9rem; opacity: 0.7; }
    .input-group { display: flex; }
    #inputBox {
      flex: 1; padding: 12px; font-size: 1rem; border-radius: 8px;
      border: 2px solid #333; background: #1f1f1f; color: inherit;
    }
    .stats { display: flex; justify-content: space-between; font-size: 1rem; font-weight: 500; }
    .encourage { text-align: center; font-size: 1rem; height: 24px; font-weight: 400; }
    @media (max-width: 480px) { .controls, .input-group { flex-direction: column; } .controls button, .controls input, #startBtn, #inputBox { width: 100%; } }
  </style>
</head>
<body>
  <div class="container">
    <div id="highDisplay"></div>
    <div id="resultDisplay"></div>
    <div class="controls">
      <input type="text" id="nameInput" placeholder="Enter your name">
      <button id="diffBtn">Difficulty: Easy</button>
      <button id="langBtn">English</button>
    </div>
    <h1 id="title">Typing Speed Test</h1>
    <button id="startBtn">Start</button>
    <div class="word-container">
      <div class="word-display" id="wordDisplay">Press Start</div>
      <div class="next-word" id="nextWord">Next: -</div>
    </div>
    <div class="input-group">
      <input type="text" id="inputBox" placeholder="Type here..." disabled>
    </div>
    <div class="stats">
      <div id="timerDisplay">Time: 30s</div>
      <div id="scoreDisplay">Score: 0</div>
    </div>
    <div class="encourage" id="encourage"></div>
  </div>
  <script>
    // Elements
    const nameInput = document.getElementById('nameInput');
    const langBtn = document.getElementById('langBtn');
    const diffBtn = document.getElementById('diffBtn');
    const startBtn = document.getElementById('startBtn');
    const titleEl = document.getElementById('title');
    const wordDisplay = document.getElementById('wordDisplay');
    const nextWord = document.getElementById('nextWord');
    const inputBox = document.getElementById('inputBox');
    const timerDisplay = document.getElementById('timerDisplay');
    const scoreDisplay = document.getElementById('scoreDisplay');
    const highDisplay = document.getElementById('highDisplay');
    const resultDisplay = document.getElementById('resultDisplay');
    const encourage = document.getElementById('encourage');

    // Data
    const difficultyBanks = {
      en: {
        Easy: ['apple','banana','orange','grape','kiwi','mango','cherry','peach','pear','plum','melon','papaya','apricot','avocado','blueberry','raspberry','blackberry','lemon','lime','coconut'],
        Medium: ['computer','keyboard','monitor','internet','browser','website','account','network','battery','storage','software','hardware','database','security','protocol','application','interface','processor','compiler','algorithm'],
        Hard: ['javascript','execution','interface','repository','integration','framework','parameter','component','optimization','asynchronous','serialization','deserialization','cryptographic','infrastructure','microservices','synchronization','multithreading','concatenation','configuration'],
        'Very Hard': ['virtualization','orchestration','authentication','authorization','containerization','microarchitecture','hyperconvergence','interoperability','parallelization','distributed','encryption','compression','decompression','loadbalancing','scalability','availability','resilience','throughput','latency']
      },
      ar: {
        سهل: ['تفاحه','موز','عنب','منجه','كمثرى','خوخ','بلح','تين','جوافه','بطيخ','رمان','فراوله','كرز','ليمون','برتقال','جزر','بطاطس','خيار','طماطم','بصل'],
        متوسط: ['حاسوب','شاشه','موقع','شحن','صفحه','برنامج','خدمه','صوره','كلمه','لوحه','نظام','ذاكره','معالج','بطاريه','انترنت','شبكه','بروتوكول','تخزين','تطوير','برمجه'],
        صعب: ['تشفير','تشغيل','سرعه','تحميل','تطبيق','متصفح','مستخدم','تقنيه','اعدادات','انترنت','تحليل','تصحيح','تكامل','مصفوفة','تشغيل','تعقب','استدعاء','تجميع','تحسين','توزيع'],
        'صعب جدا': ['معالجه','تزامن','برمجه','تحليل','اداره','مصفوفة','ادخال','اخراج','تشخيص','تكوين','تسريع','تحميل','ترتيب','تقسيم','ترابط','اعتمادية','توفر','مرونة','توازي','تخزين']
      }
    };
    let lang = 'en', diffIdx = 0;
    const difficulties = { en: ['Easy','Medium','Hard','Very Hard'], ar: ['سهل','متوسط','صعب','صعب جدا'] };
    const INITIAL_TIME = 30, INITIAL_COUNT = 10;
    let words = [], idx = 0, score = 0, timeLeft = INITIAL_TIME, timerId;
    let currentPlayer = 'Anonymous';

    // Helpers
    function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }
    function updateTimer() { timerDisplay.textContent = (lang==='en'?'Time: ':'الوقت: ')+timeLeft+(lang==='en'?'s':' ث'); }
    function updateScore() { scoreDisplay.textContent = (lang==='en'?'Score: ':'النقاط: ')+score; }
    function calculateWPM() { return Math.round((score / INITIAL_TIME) * 60); }
    function randomEnc() { const msgs = lang==='en'?['Great!','Keep going!','Awesome!','Nice!','Well done!']:['رائع!','واصل!','مدهش!','جيد!','أحسنت!']; return msgs[Math.floor(Math.random()*msgs.length)]; }

    // Initialize high score
    let highScore = parseInt(localStorage.getItem('highScore')) || 0;
    let highPlayer = localStorage.getItem('highPlayer') || 'None';
    function showHigh() {
      if(highScore > 0) {
        highDisplay.style.display = 'block';
        highDisplay.textContent = lang==='en'
          ? `Leader: ${highPlayer} - ${highScore} WPM`
          : `المتصدر: ${highPlayer} - ${highScore} ك/د`;
      }
    }
    showHigh();

    // Events
    langBtn.onclick = () => {
      lang = lang==='en'?'ar':'en';
      langBtn.textContent = lang==='en'?'English':'العربية';
      titleEl.textContent = lang==='en'?'Typing Speed Test':'اختبار سرعة الكتابة';
      startBtn.textContent = lang==='en'?'Start':'ابدأ';
      diffBtn.textContent = (lang==='en'?'Difficulty: ':'المستوى: ')+difficulties[lang][diffIdx];
      showHigh();
    };
    diffBtn.onclick = () => {
      diffIdx = (diffIdx + 1) % difficulties[lang].length;
      diffBtn.textContent = (lang==='en'?'Difficulty: ':'المستوى: ')+difficulties[lang][diffIdx];
    };
    startBtn.onclick = () => {
      currentPlayer = nameInput.value.trim() || 'Anonymous';
      timeLeft = INITIAL_TIME; score = 0; idx = 0;
      const diffKey = difficulties[lang][diffIdx];
      words = shuffle([...difficultyBanks[lang][diffKey]]).slice(0, INITIAL_COUNT);
      updateTimer(); updateScore(); resultDisplay.style.display='none'; encourage.textContent='';
      wordDisplay.innerHTML = words[0]; nextWord.textContent = (lang==='en'?'Next: ':'التالي: ')+(words[1]||'-');
      inputBox.disabled = false; inputBox.value = ''; inputBox.focus(); clearInterval(timerId);
      timerId = setInterval(()=>{ timeLeft--; updateTimer(); if(timeLeft<=0) endGame(); },1000);
    };
    inputBox.oninput = e => {
      const v = e.target.value;
      wordDisplay.innerHTML = v.split('').map((c,i)=>`<span class="${c===words[idx][i]?'correct':'incorrect'}">${c}</span>`).join('')+words[idx].slice(v.length);
      if(v===words[idx]) {
        score++; idx++; encourage.textContent=randomEnc(); updateScore(); e.target.value='';
        if(idx<words.length) {
          wordDisplay.innerHTML = words[idx]; nextWord.textContent = (lang==='en'?'Next: ':'التالي: ')+(words[idx+1]||'-');
        } else endGame();
      }
    };
    function endGame() {
      clearInterval(timerId);
      inputBox.disabled = true;
      const wpm = calculateWPM();
      if(wpm > highScore) {
        highScore = wpm;
        highPlayer = currentPlayer;
        localStorage.setItem('highScore', highScore);
        localStorage.setItem('highPlayer', highPlayer);
        showHigh();
      }
      resultDisplay.textContent = lang==='en'
        ? `${currentPlayer} finished in 30s | Level: ${difficulties[lang][diffIdx]} | ${wpm} WPM`
        : `${currentPlayer} أنهى في 30ث | المستوى: ${difficulties[lang][diffIdx]} | ${wpm} ك/د`;
      resultDisplay.style.display='block';
    }
  </script>
</body>
</html>
